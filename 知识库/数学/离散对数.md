## 1. 核心定义
离散对数是实数对数在模运算环境下的推广。建立离散对数的前提是模 $m$ **必须存在原根**。

* **定义**：设 $g$ 是模 $m$ 的一个 **原根**，对于任意与 $m$ 互素的整数 $a$（即 $(a, m)=1$），满足以下同余式的**唯一**整数 $\gamma$：
    $$a \equiv g^\gamma \pmod m, \quad 0 \le \gamma \le \varphi(m)-1$$
    称为以 $g$ 为底 $a$ 的 **离散对数**（或**指标**，Index）。
* **记号**：通常记为 $ind_g(a)$ 或 $\log_g a$。

## 2. 运算性质 (算术规则)
离散对数完美继承了普通对数“将乘法变加法”的特性，但要注意运算是在 **模 $\varphi(m)$** 的加法群中进行的。

1.  **特殊值**：
    * $ind_g(1) = 0$
    * $ind_g(g) = 1$
2.  **乘积变和**：
    $$ind_g(a \cdot b) \equiv ind_g(a) + ind_g(b) \pmod{\varphi(m)}$$
3.  **幂次变乘积**：
    $$ind_g(a^n) \equiv n \cdot ind_g(a) \pmod{\varphi(m)}$$
4.  **换底公式**：若 $g_1$ 也是原根，则
    $$ind_g(a) \equiv ind_{g_1}(a) \cdot ind_g(g_1) \pmod{\varphi(m)}$$

>[!warning] 注意
>指数形式 mod($x$),对数形式 mod($\phi(x)$)
>
>进行变形时，需要注意 mod 的增根、少根，代回验证。

## 3. 重要关联：指数与离散对数
元素 $a$ 的 **指数**（Order，即阶）可以通过其离散对数直接计算：
$$ord_m(a) = \frac{\varphi(m)}{\gcd(ind_g(a), \varphi(m))}$$
*意义：这告诉我们，一个元素的阶取决于它的离散对数与群阶 $\varphi(m)$ 的最大公约数。*

> [!example] 类比
>想象一个圆形跑道，全长 $\varphi(m)$ 米。
>- **原根 $g$**：每次跳 **1米**。它需要跳 $\varphi(m)$ 次才能回到起点（转一圈）。
>- **元素 $a$**：每次跳 **$k$ 米**（$k$ 就是离散对数）。
>  
>  **问题**：$a$ 需要跳多少次（$d$）才能回到起点？
> - 如果 $a$ 每次跳的距离 $k$ 能整除跑道长度 $\varphi(m)$，那么它只需要跳 $\varphi(m)/k$ 次。
>- 如果 $k$ 不能整除跑道长度，它可能需要多跑几圈才能恰好落在起点。
>- **公式含义**：$\gcd(k, \varphi(m))$ 代表了 $a$ 的步长 $k$ 与跑道总长 $\varphi(m)$ 的“公共节奏”。去除这个公共部分后，剩下的就是 $a$ 需要跳的次数。

## 4. 离散对数问题 (DLP)
这是密码学关注的核心。
* **正向计算（易）**：给定 $m, g, \gamma$，计算 $a \equiv g^\gamma \pmod m$。这是**模幂运算**，使用“平方-乘”算法可以非常快地算出。
* **逆向计算（难）**：给定 $m, g, a$，求 $\gamma$ 使得 $a \equiv g^\gamma \pmod m$。这就是 **离散对数问题 (Discrete Logarithm Problem, DLP)**。
    * 当 $m$ 是大素数时，目前没有已知的高效多项式时间算法能解出 $\gamma$。

## 5. 典型应用
利用 DLP 的困难性构建的密码体制：
1.  **Diffie-Hellman 密钥交换**：允许双方在公开信道协商出共享密钥 $g^{ab}$，攻击者截获 $g^a$ 和 $g^b$ 无法推算出 $g^{ab}$。
2.  **ElGamal 加密/签名**：安全性直接依赖于在有限域上求解离散对数的难度。
3.  **DSA (Digital Signature Algorithm)**：美国国家标准数字签名算法，基于 DLP 变体。

---

> [!example] 计算示例
> 模数 $m=17$，原根选 $g=3$（$\varphi(17)=16$）。
>
> 1.  **建立表（部分）**：
>     * $3^1 \equiv 3 \implies ind_3(3) = 1$
>     * $3^2 \equiv 9 \implies ind_3(9) = 2$
>     * $3^3 \equiv 27 \equiv 10 \implies ind_3(10) = 3$
> 2.  **利用性质计算**：求 $ind_3(13)$。
>     已知 $13 \equiv -4 \equiv -1 \cdot 2^2 \pmod{17}$。
>     * $ind_3(-1) = ind_3(16) = ind_3(3^8) = 8$（威尔逊定理/原根性质）。
>     * 我们需要知道 $ind_3(2)$。假设已知 $ind_3(2)=14$（因为 $3^{14} \equiv 2$）。
>     * $ind_3(13) = ind_3(-1) + 2 \cdot ind_3(2) \pmod{16}$
>     * $= 8 + 2(14) = 8 + 28 = 36 \equiv 4 \pmod{16}$。
>     * 验证：$3^4 = 81 = 4 \times 17 + 13 \equiv 13$。正确。